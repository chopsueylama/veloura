<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Veloura$ — Gem Collection</title>

  <link rel="stylesheet" href="styles.css?v=math-bg-1" />
  <!-- Inline favicon to silence 404 -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><text y='50%' x='50%' dominant-baseline='middle' text-anchor='middle' font-size='48'>$</text></svg>">
</head>

<body>
  <!-- Header -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="index.html">Veloura<span>$</span></a>
      <nav class="nav">
        <a href="index.html#collection">Collection</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
        <a href="cart.html">Cart <span id="cartBadge">0</span></a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="container section">
    <div class="section-head">
      <h1>Gemstone Collection</h1>
      <p class="muted">Original renders, real specs. Click any stone to view details and gallery.</p>
    </div>

    <div id="collection" class="grid">
      <!-- Sample cards (add the rest the same way) -->
      <article class="card">
        <a href="ceylon-blue-sapphire.html">
          <div class="card-media"><img src="/veloura/assets/ceylon-blue-sapphire/set1.png" alt="Ceylon Blue Sapphire — Cushion Cut"></div>
        </a>
        <h3><a href="ceylon-blue-sapphire.html">Ceylon Blue Sapphire — Cushion Cut</a></h3>
        <p class="muted">Blue Sapphire · Cushion · 2.45 ct</p>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>$4850</strong>
          <button class="btn" onclick='addItem({"slug":"ceylon-blue-sapphire","name":"Ceylon Blue Sapphire — Cushion Cut","price":4850})'>Add</button>
        </div>
      </article>

      <article class="card">
        <a href="padparadscha-sapphire.html">
          <div class="card-media"><img src="/veloura/assets/padparadscha-sapphire/set1.png" alt="Padparadscha Sapphire — Oval"></div>
        </a>
        <h3><a href="padparadscha-sapphire.html">Padparadscha Sapphire — Oval</a></h3>
        <p class="muted">Padparadscha Sapphire · Oval · 1.62 ct</p>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>$9200</strong>
          <button class="btn" onclick='addItem({"slug":"padparadscha-sapphire","name":"Padparadscha Sapphire — Oval","price":9200})'>Add</button>
        </div>
      </article>

      <article class="card">
        <a href="ruby.html">
          <div class="card-media"><img src="/veloura/assets/ruby/set1.png" alt="Ruby — Pigeon Blood Tone"></div>
        </a>
        <h3><a href="ruby.html">Ruby — Pigeon Blood Tone</a></h3>
        <p class="muted">Ruby · Mixed oval · 1.18 ct</p>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>$3650</strong>
          <button class="btn" onclick='addItem({"slug":"ruby","name":"Ruby — Pigeon Blood Tone","price":3650})'>Add</button>
        </div>
      </article>

      <article class="card">
        <a href="alexandrite.html">
          <div class="card-media"><img src="/veloura/assets/alexandrite/set1.png" alt="Alexandrite — Color-Change"></div>
        </a>
        <h3><a href="alexandrite.html">Alexandrite — Color-Change</a></h3>
        <p class="muted">Alexandrite · Pear · 0.88 ct</p>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>$5400</strong>
          <button class="btn" onclick='addItem({"slug":"alexandrite","name":"Alexandrite — Color-Change","price":5400})'>Add</button>
        </div>
      </article>

      <article class="card">
        <a href="spinel.html">
          <div class="card-media"><img src="/veloura/assets/spinel/set1.png" alt="Spinel — Neon Pink"></div>
        </a>
        <h3><a href="spinel.html">Spinel — Neon Pink</a></h3>
        <p class="muted">Spinel · Cushion · 1.05 ct</p>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>$2150</strong>
          <button class="btn" onclick='addItem({"slug":"spinel","name":"Spinel — Neon Pink","price":2150})'>Add</button>
        </div>
      </article>
    </div>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container">
      <strong>Veloura<span>$</span></strong>
      <span class="muted">© <span id="year"></span></span>
      <div style="margin-top:12px">
        <label class="motion-toggle" title="Reduce animations">
          <input id="motionToggle" type="checkbox" /> Reduce motion
        </label>
      </div>
    </div>
  </footer>

  <!-- Core site scripts -->
  <script>
    /* Cart */
    const CART_KEY='veloura_cart_v1';
    function getCart(){ try{return JSON.parse(localStorage.getItem(CART_KEY))||[]}catch{return[]} }
    function setCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); refreshBadges(); }
    function addItem(i){ const c=getCart(); const k=c.findIndex(x=>x.slug===i.slug); if(k>=0)c[k].qty+=1; else c.push({...i,qty:1}); setCart(c); alert(i.name+' added to cart.'); }
    function refreshBadges(){ const n=getCart().reduce((a,b)=>a+b.qty,0); const el=document.getElementById('cartBadge'); if(el) el.textContent=n; }
    refreshBadges();

    /* Footer year */
    document.getElementById('year').textContent = new Date().getFullYear();

    /* Sparkle cursor (CSS vars) */
    (function(){ const root=document.documentElement; let raf=null;
      function onMove(e){ const t=e.touches?e.touches[0]:e;
        if(raf) cancelAnimationFrame(raf);
        raf=requestAnimationFrame(()=>{ root.style.setProperty('--sx', t.clientX+'px'); root.style.setProperty('--sy', t.clientY+'px'); });
      }
      addEventListener('mousemove', onMove, {passive:true});
      addEventListener('touchmove', onMove, {passive:true});
    })();

    /* Reduce Motion toggle (persist) */
    (function(){
      const KEY='veloura_reduce_motion';
      const setMuted=(m)=>{ document.body.classList.toggle('motion-muted', !!m); try{ localStorage.setItem(KEY, m?'1':'0'); }catch{} };
      try{ setMuted(localStorage.getItem(KEY)==='1'); }catch{}
      const el=document.getElementById('motionToggle');
      if(el){ el.checked=document.body.classList.contains('motion-muted'); el.addEventListener('change',()=>setMuted(el.checked)); }
    })();
  </script>

  <!-- 3D mathematical background (Lissajous ribbon) — beneath gradient -->
  <canvas id="bg3d" aria-hidden="true"></canvas>
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script>
  (function(){
    if (document.body.classList.contains('motion-muted') ||
        window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

    const canvas = document.getElementById('bg3d');
    const renderer = new THREE.WebGLRenderer({ canvas, alpha:true, antialias:true });
    renderer.setPixelRatio(Math.min(window.devicePixelRatio||1, 2));
    renderer.setSize(innerWidth, innerHeight);
    renderer.outputColorSpace = THREE.SRGBColorSpace;
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.0;
    renderer.setClearColor(0x000000, 0);   // FULLY TRANSPARENT — no dark fill

    // Ensure stacking beneath gradient via CSS (z-index:-2)
    canvas.style.position='fixed'; canvas.style.inset='0'; canvas.style.zIndex='-2'; canvas.style.pointerEvents='none';

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(55, innerWidth/innerHeight, 0.1, 100);
    camera.position.set(0,0,10);

    // Soft ambience only (line is emissive-like)
    scene.add(new THREE.AmbientLight(0xffffff, 0.2));

    // ---- Lissajous Ribbon ----
    const N = 900;                 // points
    const a = 3, b = 4, c = 5;     // frequencies
    const ampX = 4.8, ampY = 2.8, ampZ = 2.0;
    const phase = Math.PI/3;

    const geom = new THREE.BufferGeometry();
    const positions = new Float32Array(N*3);
    geom.setAttribute('position', new THREE.BufferAttribute(positions, 3));

    const colors = new Float32Array(N*3);
    for (let i=0;i<N;i++){
      const t = i/(N-1);
      // champagne → pale gold → faint sapphire
      const r = 191/255*(1-t) + 190/255*t;
      const g = 162/255*(1-t) + 208/255*t;
      const bcol = 106/255*(1-t) + 230/255*t*0.6;
      colors[i*3+0]=r; colors[i*3+1]=g; colors[i*3+2]=bcol;
    }
    geom.setAttribute('color', new THREE.BufferAttribute(colors, 3));

    const mat = new THREE.LineBasicMaterial({ vertexColors:true, transparent:true, opacity:0.9 });
    const ribbon = new THREE.Line(geom, mat);
    scene.add(ribbon);

    let tGlobal = 0;
    function updatePositions(dt){
      tGlobal += dt * 0.35;
      const pos = geom.attributes.position.array;
      for (let i=0;i<N;i++){
        const u = i/(N-1) * Math.PI*2;
        pos[i*3+0] = ampX * Math.sin(a*u + phase + 0.25*tGlobal);
        pos[i*3+1] = ampY * Math.sin(b*u + 0.5*phase + 0.37*tGlobal);
        pos[i*3+2] = ampZ * Math.sin(c*u + 0.75*phase + 0.53*tGlobal);
      }
      geom.attributes.position.needsUpdate = true;
      ribbon.rotation.y += 0.0018;
      ribbon.rotation.x += 0.0012;
    }

    // Pointer parallax
    let targetRX=0, targetRY=0;
    function onPointer(e){
      const p = e.touches ? e.touches[0] : e;
      const nx = (p.clientX/innerWidth)*2-1;
      const ny = (p.clientY/innerHeight)*2-1;
      targetRY = nx * 0.15;
      targetRX = -ny * 0.10;
    }
    addEventListener('mousemove', onPointer, {passive:true});
    addEventListener('touchmove', onPointer, {passive:true});

    let last = performance.now();
    function tick(now){
      const dt = (now - last)/1000; last = now;
      updatePositions(dt);
      ribbon.rotation.y += (targetRY - ribbon.rotation.y)*0.04;
      ribbon.rotation.x += (targetRX - ribbon.rotation.x)*0.04;
      renderer.render(scene, camera);
      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);

    addEventListener('resize', ()=>{
      renderer.setSize(innerWidth, innerHeight);
      camera.aspect = innerWidth/innerHeight;
      camera.updateProjectionMatrix();
    });
  })();
  </script>
</body>
</html>